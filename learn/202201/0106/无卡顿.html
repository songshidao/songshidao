
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>键盘控制div移动，解决停顿的问题</title>
	<style>
		body { margin: 0; padding: 0; }
		#div1 { width: 100px; height: 100px; border: 1px solid #eee; background: #24a8a3; position: absolute;}
	</style>
</head>
<body>
	<div id="div1"></div>
	
	<script type="text/javascript">
		const oDiv = document.querySelector('#div1')
		let n=0,
		L=null,
		R=null,
		U=null,
		D=null,
		l = false,
		r = false,
		u = false,
		d = false,
		nowL = null,
		nowT = null
		
		document.onkeydown = function(ev){
			nowL = parseFloat(getComputedStyle(oDiv).left)
			nowT = parseFloat(getComputedStyle(oDiv).top)
			n=0
			if(ev.keyCode==37){
				l=true
				if(l){
					clearInterval(L)
					L= setInterval(function (){
						oDiv.style.left = nowL-n+'px'
						n++
					},10)
				}
			}else if(ev.keyCode==38){
				u=true
				if(u){
					clearInterval(U)
					U= setInterval(function (){
					oDiv.style.top = nowT-n+'px'
					n++
					},10)
				}
			}else if(ev.keyCode==39){
				r= true
				if(r){
					clearInterval(R)
					R= setInterval(function (){
					oDiv.style.left = nowL+n+'px'
					n++
					},10)
				}
			}else if(ev.keyCode==40){
				d=true
				if(d){
					clearInterval(D)
					D= setInterval(function (){
					oDiv.style.top = nowT+n+'px'
					n++
					},10)
				}
				
			}
			console.log(ev.keyCode)
		}
		document.onkeyup = function(ev){
			if(ev.keyCode==37){
				clearInterval(L)
				l=false
			}else if(ev.keyCode==38){
				clearInterval(U)
				u=false
			}else if(ev.keyCode==39){
				clearInterval(R)
				r=false
			}else if(ev.keyCode==40){
				clearInterval(D)
				d=false
			}
			console.log(ev.keyCode)
		}
	</script>
</body>
</html>